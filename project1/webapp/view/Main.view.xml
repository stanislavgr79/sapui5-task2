<mvc:View controllerName="project1.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core">
    <Page id="page" title="{i18n>title}">
        <content>
            <Panel accessibleRole="Region">
                <Table id="booksTable"
                    class="sapUiResponsiveMargin"
                    width="auto"
                    mode="MultiSelect"
                    selectionChange="onSelectionChange"
                    items="{
                        path: 'books>/books'
                    }">
                <headerToolbar>
                    <OverflowToolbar>
                        <content>
                            <Title text="Books Library" level="H2"/>
                            <ToolbarSpacer/>
                            <Label text="Total Books:"/>
                            <Text text="{books>/books/length}"/>
                        </content>
                    </OverflowToolbar>
                </headerToolbar>
                <infoToolbar>
                    <OverflowToolbar>
                        <Label text="Available books in the library"/>
                        <ToolbarSpacer/>
                        <Input 
                            id="bookTitleInput"
                            width="15em"
                            placeholder="Filter by title..."/>
                        <Select
                            id="genreSelect"
                            width="10em"
                            forceSelection="false"
                            selectedKey="{books>/SelectedGenre}"
                            items="{books>/booksGenre}">
                            <core:Item key="{books>key}" text="{books>text}" />
                        </Select>
                        <Button text="Filter" press="onFilter" type="Emphasized"/>
                    </OverflowToolbar>
                </infoToolbar>
                <columns>
                    <Column width="4em">
                        <Text text="ID"/>
                    </Column>
                    <Column
                        width="25em"
                        minScreenWidth="Tablet"
                        demandPopin="true">
                        <Text text="Name"/>
                    </Column>
                    <Column
                        width="12em"
                        minScreenWidth="Tablet"
                        demandPopin="true">
                        <Text text="Author"/>
                    </Column>
                    <Column
                        minScreenWidth="Desktop"
                        demandPopin="true"
                        hAlign="Center">
                        <Text text="Genre"/>
                    </Column>
                    <Column
                        minScreenWidth="Desktop"
                        demandPopin="true"
                        hAlign="Center">
                        <Text text="Release Date"/>
                    </Column>
                    <Column
                        hAlign="Center"
                        width="6em">
                        <Text text="Available"/>
                    </Column>
                    <Column
                        hAlign="Center">
                        <Text text="Actions"/>
                    </Column>
                </columns>
                <items>
                    <ColumnListItem vAlign="Middle">
                        <cells>
                            <ObjectIdentifier title="{books>ID}"/>
                            <VBox>
                                <Text text="{books>Name}" visible="{= ${books>isEditMode} !== true }"/>
                                <Input class="rowEditInput" value="{books>Name}" visible="{= ${books>isEditMode} === true }"
                                    submit="onSave"/>
                            </VBox>
                            <Text text="{books>Author}"/>
                            <Text text="{books>Genre}"/>
                            <Text text="{
                                path: 'books>ReleaseDate',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: {
                                    pattern: 'dd MMM yyyy'
                                }
                            }"/>
                            <ObjectNumber
                                number="{books>AvailableQuantity}"
                                unit="pcs"/>
                            <HBox justifyContent="Center" class="actionButtons">
                                <Button text="Edit" type="Transparent"
                                    press="onEdit" visible="{= ${books>isEditMode} !== true }" width="4rem"/>
                                <Button text="Save" type="Transparent"
                                    press="onSave" visible="{= ${books>isEditMode} === true }" width="4rem"/>
                            </HBox>
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
            <Toolbar>
                <ToolbarSpacer/>
                <Button text="Add Record" press=".onOpenAddRecordDialog" type="Accept"/>
                <Button text="Delete Records" press=".onDeleteDialogPress" type="Reject" enabled="{= ${books>/selectedItems} > 0}"/>
            </Toolbar>
        </Panel>
        </content>
    </Page>
</mvc:View>